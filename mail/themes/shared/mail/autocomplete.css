/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, you can obtain one at http://mozilla.org/MPL/2.0/. */

#PopupAutoComplete > richlistbox {
  padding: 0;
}

#PopupAutoComplete > richlistbox > richlistitem {
  min-height: 20px;
  border: 0;
  border-radius: 0;
  padding: 0 1px;

  --status-text-color: currentColor;
  --status-background-color: rgba(248, 232, 28, 0.2);

  &:hover {
    background-color: var(--arrowpanel-dimmed);
  }

  &[selected] {
    background-color: var(--selected-item-color);
    color: var(--selected-item-text-color);
  }

  & > .ac-site-icon {
    margin-inline: 4px 0;
  }

  & > .ac-login-item {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;

    & > .ac-secondary-action {
      display: none;
    }
  }

  & > .ac-title {
    font: icon;
    margin-inline-start: 4px;
  }

  &[originaltype="insecureWarning"] {
    height: auto;

    & > .ac-title > .ac-text-overflow-container > .ac-title-text {
      text-overflow: initial;
      white-space: initial;
    }

    & > .ac-title > label {
      margin-inline-start: 0;
    }
  }

  &[originaltype="loginWithOrigin"] > .ac-site-icon,
  &[originaltype="insecureWarning"] > .ac-site-icon {
    margin-inline-start: 0;
    display: initial;
  }

  &[originaltype="login"] > .ac-site-icon,
  &[originaltype="possible-username"] > .ac-site-icon,
  & > .two-line-wrapper > .ac-site-icon {
    display: block;
    margin-inline: 4px;
  }

  &[originaltype="possible-username"] > .ac-site-icon {
    visibility: hidden;
  }

  /* Autocomplete richlistitem support for a two-line label display */

  & > .two-line-wrapper {
    box-sizing: border-box;
    display: flex;
    align-items: center;
    flex-direction: row;
    gap: 8px;
    margin: 0;
    min-width: 0;

    & > .ac-site-icon {
      margin-inline-start: 6px;
    }

    & > .ac-site-icon[src=""] {
      display: none;
    }

    & > .labels-wrapper {
      /* The text should flex while the icon should not */
      flex: 1;
      /* min-width is needed to get the text-overflow: ellipsis to work for the children */
      min-width: 0;

      & > .label-row {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      & .line2-label {
        padding-top: 2px !important;
        color: var(--text-color-deemphasized);
      }
    }
  }

  /* Login form autocompletion (with and without origin showing) */
  &[originaltype="loginWithOrigin"] > .two-line-wrapper > .ac-site-icon,
  &[originaltype="login"] > .ac-site-icon {
    fill: GrayText;
  }

  &[originaltype="loginWithOrigin"][selected] > .two-line-wrapper > .ac-site-icon,
  &[originaltype="login"] > .ac-site-icon[selected] {
    fill: SelectedItemText;
  }

  /* Login form autocompletion */
  & > .two-line-wrapper {
    padding: 4px;
    padding-inline-start: 6px;
  }

  &[originaltype="action"] > .two-line-wrapper {
    flex: 1;
  }

  &[originaltype="action"] {
    text-align: center;
  }

  /* status items */
  & > .ac-status {
    padding: 4px 8px;
    text-align: center;
    background-color: var(--status-background-color);
    color: var(--status-text-color);
    width: 100%;
    border-bottom: 1px solid var(--panel-separator-color);
    font-size: calc(10 / 12 * 1em);
  }

  &:has(> .ac-status) {
    opacity: 1;
  }

  &[originaltype="autofill"][ac-image]:not([ac-image=""]) > .two-line-wrapper {
    display: grid;
    grid-template-columns: 32px 1fr;

    & > .ac-site-icon {
      width: auto;
      height: 16px;
      max-width: 32px;
      max-height: 16px;
    }
  }

  /* Insecure field warning */
  &[originaltype="insecureWarning"] {
    background-color: var(--arrowpanel-dimmed);
    color: inherit;
    border-bottom: 1px solid var(--panel-separator-color);
    padding-block: 4px;

    &[selected] {
      background-color: var(--arrowpanel-dimmed-further);
      color: inherit;
    }

    & > .ac-title {
      font-size: 1rem;
    }

    & > .ac-title .ac-emphasize-text-title {
      font-weight: 600;
    }

    & > .ac-site-icon {
      list-style-image: url(chrome://global/skin/icons/security-broken.svg);
    }
  }
}
